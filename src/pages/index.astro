---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/home/Hero.astro';
import Programs from '../components/home/Programs.astro';
import AcademicExperience from '../components/home/AcademicExperience.astro';
import CampusLife from '../components/home/CampusLife.astro';
import News from '../components/home/News.astro';
import Events from '../components/home/Events.astro';

import {
  getHero,
  getPrograms,
  getAcademicExperience,
  getCampusLife,
  getNews,
  getEvents,
} from '../utils/contentful';

const hero = await getHero();
const programs = await getPrograms();
const academicExperience = await getAcademicExperience();
const campusLife = await getCampusLife();
const news = await getNews(3); // Limit to 3 news items
const events = await getEvents();

// Redirect to 404 if essential content is missing
if (!hero || !academicExperience || !campusLife) {
  return Astro.redirect('/404');
}
---

<Layout title="Welcome to Our University">
  <Hero hero={hero} />
  <Programs programs={programs} />
  <AcademicExperience experience={academicExperience} />
  <CampusLife campusLife={campusLife} />
  <News news={news} />
  <Events events={events} />
</Layout>
